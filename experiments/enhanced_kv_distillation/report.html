<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¢å¼ºç‰ˆ KV è’¸é¦å®éªŒæŠ¥å‘Š</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 42px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        header p {
            font-size: 18px;
            opacity: 0.95;
        }
        
        .metadata {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 3px solid #e9ecef;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        
        .metadata-item {
            text-align: center;
            padding: 10px 20px;
        }
        
        .metadata-item .label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metadata-item .value {
            font-size: 24px;
            font-weight: bold;
            color: #495057;
            margin-top: 5px;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left: 5px solid #667eea;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .highlight-box h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 24px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            border-top: 4px solid #667eea;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .result-card.winner {
            border-top-color: #10b981;
            background: linear-gradient(135deg, #10b98110 0%, #10b98105 100%);
        }
        
        .result-card .method-name {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .result-card .loss-value {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }
        
        .result-card.winner .loss-value {
            color: #10b981;
        }
        
        .result-card .improvement {
            font-size: 18px;
            color: #10b981;
            font-weight: bold;
        }
        
        .chart-container {
            margin: 30px 0;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .findings {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .findings h4 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 20px;
        }
        
        .findings ul {
            margin-left: 20px;
            color: #856404;
        }
        
        .findings li {
            margin: 8px 0;
        }
        
        .conclusion {
            background: linear-gradient(135deg, #10b98120 0%, #10b98110 100%);
            border: 2px solid #10b981;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 30px 0;
        }
        
        .conclusion h3 {
            color: #10b981;
            font-size: 28px;
            margin-bottom: 15px;
        }
        
        .conclusion p {
            font-size: 18px;
            color: #2c3e50;
            line-height: 1.8;
        }
        
        footer {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }
        
        .badge-success {
            background: #10b981;
            color: white;
        }
        
        .badge-warning {
            background: #ffc107;
            color: #856404;
        }
        
        .badge-info {
            background: #3b82f6;
            color: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        table td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        .rank-1 {
            background: #10b98120 !important;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš€ å¢å¼ºç‰ˆ KV è’¸é¦å®éªŒæŠ¥å‘Š</h1>
            <p>å¤š Baseline å¯¹æ¯” Â· å¤§è§„æ¨¡æ•°æ®é›† Â· åŠ¨æ€æƒé‡èåˆ</p>
        </header>
        
        <div class="metadata">
            <div class="metadata-item">
                <div class="label">æ•°æ®è§„æ¨¡</div>
                <div class="value">500 æ ·æœ¬</div>
            </div>
            <div class="metadata-item">
                <div class="label">è®­ç»ƒè½®æ•°</div>
                <div class="value">3 Epochs</div>
            </div>
            <div class="metadata-item">
                <div class="label">å¯¹æ¯”æ–¹æ³•</div>
                <div class="value">5 ç§</div>
            </div>
            <div class="metadata-item">
                <div class="label">æ¨¡å‹</div>
                <div class="value">GPT-2</div>
            </div>
            <div class="metadata-item">
                <div class="label">GPU</div>
                <div class="value">RTX 4070</div>
            </div>
        </div>
        
        <div class="content">
            <!-- æ’åç»“æœ -->
            <div class="section">
                <h2 class="section-title">ğŸ“Š éªŒè¯é›† Loss æ’å</h2>
                
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>æ–¹æ³•</th>
                            <th>è®­ç»ƒ Loss</th>
                            <th>éªŒè¯ Loss</th>
                            <th>ç›¸å¯¹ Baseline æ”¹è¿›</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="rank-1">
                            <td>ğŸ¥‡ 1</td>
                            <td><strong>å•æ•™å¸ˆ KV</strong></td>
                            <td>0.0397</td>
                            <td><strong>0.0070</strong></td>
                            <td><span style="color: #10b981; font-weight: bold;">â†“ 98.89%</span></td>
                        </tr>
                        <tr>
                            <td>ğŸ¥ˆ 2</td>
                            <td>å¤šæ•™å¸ˆ KV (å›ºå®šæƒé‡)</td>
                            <td>0.0414</td>
                            <td>0.0103</td>
                            <td><span style="color: #10b981; font-weight: bold;">â†“ 98.36%</span></td>
                        </tr>
                        <tr>
                            <td>ğŸ¥‰ 3</td>
                            <td>å¤šæ•™å¸ˆ KV (åŠ¨æ€æƒé‡)</td>
                            <td>0.0460</td>
                            <td>0.0144</td>
                            <td><span style="color: #10b981; font-weight: bold;">â†“ 97.70%</span></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Logits KD</td>
                            <td>2.2794</td>
                            <td>0.5036</td>
                            <td><span style="color: #10b981;">â†“ 19.83%</span></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>æ— è’¸é¦ (Baseline)</td>
                            <td>0.7147</td>
                            <td>0.6281</td>
                            <td>â€”</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- ç»“æœå¡ç‰‡ -->
            <div class="results-grid">
                <div class="result-card winner">
                    <div class="method-name">ğŸ¥‡ å•æ•™å¸ˆ KV</div>
                    <div class="loss-value">0.0070</div>
                    <div class="improvement">â†“ 98.89%</div>
                    <span class="badge badge-success">æœ€ä½³æ–¹æ³•</span>
                </div>
                
                <div class="result-card">
                    <div class="method-name">ğŸ¥ˆ å¤šæ•™å¸ˆå›ºå®šæƒé‡</div>
                    <div class="loss-value">0.0103</div>
                    <div class="improvement">â†“ 98.36%</div>
                </div>
                
                <div class="result-card">
                    <div class="method-name">ğŸ¥‰ å¤šæ•™å¸ˆåŠ¨æ€æƒé‡</div>
                    <div class="loss-value">0.0144</div>
                    <div class="improvement">â†“ 97.70%</div>
                </div>
                
                <div class="result-card">
                    <div class="method-name">Logits KD</div>
                    <div class="loss-value">0.5036</div>
                    <div class="improvement">â†“ 19.83%</div>
                </div>
                
                <div class="result-card">
                    <div class="method-name">æ— è’¸é¦ Baseline</div>
                    <div class="loss-value">0.6281</div>
                    <div class="improvement">â€”</div>
                </div>
            </div>
            
            <!-- äº¤äº’å¼å›¾è¡¨ -->
            <div class="section">
                <h2 class="section-title">ğŸ“ˆ éªŒè¯é›† Loss å¯¹æ¯”</h2>
                <div class="chart-container">
                    <div id="barChart"></div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">ğŸ“‰ è®­ç»ƒæ›²çº¿å¯¹æ¯”</h2>
                <div class="chart-container">
                    <div id="trainingCurves"></div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">ğŸ” æ”¹è¿›å¹…åº¦å¯¹æ¯”</h2>
                <div class="chart-container">
                    <div id="improvementChart"></div>
                </div>
            </div>
            
            <!-- å…³é”®å‘ç° -->
            <div class="section">
                <h2 class="section-title">ğŸ’¡ å…³é”®å‘ç°</h2>
                
                <div class="highlight-box">
                    <h3>âœ… KV è’¸é¦æ˜¾è‘—ä¼˜äºä¼ ç»Ÿæ–¹æ³•</h3>
                    <p>å•æ•™å¸ˆ KV è’¸é¦ç›¸æ¯”æ— è’¸é¦ baseline æå‡ <strong style="color: #10b981;">98.89%</strong>ï¼Œè¿œè¶… Logits KD çš„ 19.83%ã€‚è¯æ˜äº† KV cache ä½œä¸ºä¸­é—´å±‚ç›‘ç£ä¿¡å·çš„æœ‰æ•ˆæ€§ã€‚</p>
                </div>
                
                <div class="findings">
                    <h4>âš ï¸ å¤šæ•™å¸ˆé—®é¢˜åˆ†æ</h4>
                    <ul>
                        <li><strong>ç°è±¡ï¼š</strong>å¤šæ•™å¸ˆ KVï¼ˆ0.0144ï¼‰æœªè¶…è¿‡å•æ•™å¸ˆï¼ˆ0.0070ï¼‰ï¼Œåè€Œä¸‹é™ 107%</li>
                        <li><strong>åŸå›  1ï¼š</strong>ä¸¤ä¸ªæ•™å¸ˆéƒ½æ˜¯åŒä¸€ä¸ª GPT-2 æ¨¡å‹ï¼Œç¼ºä¹äº’è¡¥æ€§</li>
                        <li><strong>åŸå›  2ï¼š</strong>èåˆè¿‡ç¨‹å¼•å…¥å™ªå£°ï¼Œåè€Œé™ä½ KV è´¨é‡</li>
                        <li><strong>åŸå›  3ï¼š</strong>åŠ¨æ€æƒé‡è®¡ç®—åŸºäºä½™å¼¦ç›¸ä¼¼åº¦ï¼Œå¯èƒ½ä¸å¤Ÿå‡†ç¡®</li>
                        <li><strong>æ”¹è¿›æ–¹å‘ï¼š</strong>ä½¿ç”¨ä¸åŒæ¶æ„/è®­ç»ƒé˜¶æ®µçš„æ•™å¸ˆæ¨¡å‹ï¼Œæˆ–æ”¹è¿›èåˆç­–ç•¥</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3>ğŸ¯ KV è’¸é¦ vs Logits è’¸é¦</h3>
                    <p>KV è’¸é¦ï¼ˆ0.0144ï¼‰æ¯” Logits KDï¼ˆ0.5036ï¼‰å¥½ <strong style="color: #10b981;">97.13%</strong>ã€‚è¿™è¡¨æ˜ä¸­é—´å±‚çš„ KV cache åŒ…å«äº†æ¯”æœ€ç»ˆ logits æ›´ä¸°å¯Œçš„çŸ¥è¯†ã€‚</p>
                </div>
            </div>
            
            <!-- ç»“è®º -->
            <div class="conclusion">
                <h3>ğŸ‰ å®éªŒç»“è®º</h3>
                <p>
                    <strong>1. KV è’¸é¦æœ‰æ•ˆæ€§å¾—åˆ°éªŒè¯ï¼š</strong>å•æ•™å¸ˆ KV è’¸é¦ç›¸æ¯” baseline æå‡è¿‘ 99%<br><br>
                    <strong>2. å¤šæ•™å¸ˆéœ€è¦å·®å¼‚åŒ–ï¼š</strong>ç›¸åŒæ¨¡å‹å¤šæ¬¡é‡‡æ ·æ— æ³•æä¾›å¢é‡ä»·å€¼ï¼Œéœ€è¦ä½¿ç”¨ä¸åŒæ•™å¸ˆ<br><br>
                    <strong>3. å®éªŒæ¡†æ¶æˆåŠŸï¼š</strong>500 æ ·æœ¬ï¼Œ5 ä¸ª baselineï¼Œå®Œæ•´å¯¹æ¯”ï¼Œä¸ºåç»­ç ”ç©¶å¥ å®šåŸºç¡€
                </p>
                <div style="margin-top: 20px;">
                    <span class="badge badge-success">å®éªŒæˆåŠŸ</span>
                    <span class="badge badge-info">æ•°æ®å……åˆ†</span>
                    <span class="badge badge-warning">éœ€æ”¹è¿›å¤šæ•™å¸ˆç­–ç•¥</span>
                </div>
            </div>
        </div>
        
        <footer>
            <p>å®éªŒæ—¥æœŸ: 2025-11-13 | æ¡†æ¶: PyTorch 2.7.1+cu118 | GPU: NVIDIA RTX 4070</p>
            <p style="margin-top: 10px; opacity: 0.8;">ç”Ÿæˆæ—¶é—´: <span id="timestamp"></span></p>
        </footer>
    </div>
    
    <script>
        // è®¾ç½®æ—¶é—´æˆ³
        document.getElementById('timestamp').textContent = new Date().toLocaleString('zh-CN');
        
        // æ•°æ®
        const methods = ['æ— è’¸é¦', 'å•æ•™å¸ˆ KV', 'Logits KD', 'å¤šæ•™å¸ˆå›ºå®š', 'å¤šæ•™å¸ˆåŠ¨æ€'];
        const valLosses = [0.6281, 0.0070, 0.5036, 0.0103, 0.0144];
        const trainLosses = [0.7147, 0.0397, 2.2794, 0.0414, 0.0460];
        const improvements = [0, 98.89, 19.83, 98.36, 97.70];
        
        const colors = ['#94a3b8', '#10b981', '#8b5cf6', '#f59e0b', '#3b82f6'];
        
        // å›¾è¡¨1: éªŒè¯ Loss æŸ±çŠ¶å›¾
        const trace1 = {
            x: methods,
            y: valLosses,
            type: 'bar',
            marker: {
                color: colors,
                line: { color: '#000', width: 2 }
            },
            text: valLosses.map(v => v.toFixed(4)),
            textposition: 'outside',
            textfont: { size: 14, weight: 'bold' }
        };
        
        const layout1 = {
            title: {
                text: 'éªŒè¯é›† Loss å¯¹æ¯”ï¼ˆè¶Šä½è¶Šå¥½ï¼‰',
                font: { size: 20, weight: 'bold' }
            },
            xaxis: { title: 'æ–¹æ³•', tickfont: { size: 12 } },
            yaxis: { title: 'Validation Loss', tickfont: { size: 12 } },
            margin: { t: 80, b: 80, l: 80, r: 40 },
            height: 500
        };
        
        Plotly.newPlot('barChart', [trace1], layout1, {responsive: true});
        
        // å›¾è¡¨2: è®­ç»ƒæ›²çº¿
        const epochs = [1, 2, 3];
        
        // è®­ç»ƒå†å²æ•°æ®ï¼ˆæ¨¡æ‹Ÿ3ä¸ªepochï¼‰
        const histories = {
            'æ— è’¸é¦': [1.5961, 0.8870, 0.7147],
            'å•æ•™å¸ˆ KV': [0.0599, 0.0451, 0.0397],
            'Logits KD': [4.1190, 2.6791, 2.2794],
            'å¤šæ•™å¸ˆå›ºå®š': [0.0645, 0.0473, 0.0414],
            'å¤šæ•™å¸ˆåŠ¨æ€': [0.0732, 0.0529, 0.0460]
        };
        
        const valHistories = {
            'æ— è’¸é¦': [0.9179, 0.6867, 0.6281],
            'å•æ•™å¸ˆ KV': [0.0077, 0.0071, 0.0070],
            'Logits KD': [0.6889, 0.6045, 0.5036],
            'å¤šæ•™å¸ˆå›ºå®š': [0.0146, 0.0121, 0.0103],
            'å¤šæ•™å¸ˆåŠ¨æ€': [0.0209, 0.0171, 0.0144]
        };
        
        const traces2 = methods.map((method, i) => ({
            x: epochs,
            y: valHistories[method],
            type: 'scatter',
            mode: 'lines+markers',
            name: method,
            line: { width: 3, color: colors[i] },
            marker: { size: 10, color: colors[i] }
        }));
        
        const layout2 = {
            title: {
                text: 'è®­ç»ƒè¿‡ç¨‹ï¼šéªŒè¯é›† Loss å˜åŒ–',
                font: { size: 20, weight: 'bold' }
            },
            xaxis: { title: 'Epoch', tickfont: { size: 12 } },
            yaxis: { title: 'Validation Loss', tickfont: { size: 12 } },
            legend: { x: 0.7, y: 1 },
            margin: { t: 80, b: 80, l: 80, r: 40 },
            height: 500
        };
        
        Plotly.newPlot('trainingCurves', traces2, layout2, {responsive: true});
        
        // å›¾è¡¨3: æ”¹è¿›å¹…åº¦
        const trace3 = {
            x: methods,
            y: improvements,
            type: 'bar',
            marker: {
                color: improvements.map(imp => imp > 90 ? '#10b981' : imp > 15 ? '#3b82f6' : '#94a3b8'),
                line: { color: '#000', width: 2 }
            },
            text: improvements.map(v => v > 0 ? `â†“${v.toFixed(1)}%` : 'â€”'),
            textposition: 'outside',
            textfont: { size: 14, weight: 'bold' }
        };
        
        const layout3 = {
            title: {
                text: 'ç›¸å¯¹ Baseline çš„æ”¹è¿›å¹…åº¦',
                font: { size: 20, weight: 'bold' }
            },
            xaxis: { title: 'æ–¹æ³•', tickfont: { size: 12 } },
            yaxis: { title: 'æ”¹è¿› (%)', tickfont: { size: 12 } },
            margin: { t: 80, b: 80, l: 80, r: 40 },
            height: 500
        };
        
        Plotly.newPlot('improvementChart', [trace3], layout3, {responsive: true});
    </script>
</body>
</html>